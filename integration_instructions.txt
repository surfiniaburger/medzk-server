# Integrating swift.html into ee.html

This document provides instructions on integrating `swift.html` into `ee.html` to create an interactive quiz popup when an "Airquality" hotspot is clicked.  The quiz will now receive the location of the clicked hotspot.

## Step 1: Modify ee.html

1. **Add a container for the popup:** Inside the `<body>` of `ee.html`, add a `<div>` to hold the `swift.html` content. This div should initially be hidden.

```html
<div id="swift-popup" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1002;"></div>
```

2. **Modify the `analyzeHotspot` function:** Add code to open the popup if the hotspot type is "Airquality". Use `document.getElementById('swift-popup').innerHTML` to load the content of `swift.html` into the popup, passing the hotspot's latitude and longitude as parameters.

```javascript
// ... inside analyzeHotspot function ...
if (currentHotspot.type === "AirQuality") {
    const lat = currentHotspot.markerLocation.lat;
    const lng = currentHotspot.markerLocation.lng;
    // Load swift.html into the popup, passing latitude and longitude
    const url = `swift.html?lat=${lat}&lng=${lng}`;
    fetch(url)
        .then(response => response.text())
        .then(html => {
            document.getElementById('swift-popup').innerHTML = html;
            document.getElementById('swift-popup').style.display = 'block';
            // Add event listener to close popup and update score after quiz completion
            // ... (see Step 2) ...
        });
}
// ... rest of analyzeHotspot function ...
```

3. **Add a function to close the popup and update the score:** This function will be called from `swift.html` after the quiz is completed.

```javascript
function closeSwiftPopupAndUpdateScore(score) {
    document.getElementById('swift-popup').style.display = 'none';
    environmentalScore += score;
    document.getElementById('score').textContent = `Environmental Score: ${environmentalScore}`;
    updateSustainabilityRating();
}
```

## Step 2: Modify swift.html

1. **Retrieve latitude and longitude from URL parameters:** Add JavaScript code to `swift.html` to retrieve the latitude and longitude from the URL parameters using `URLSearchParams`.

```javascript
const urlParams = new URLSearchParams(window.location.search);
const lat = urlParams.get('lat');
const lng = urlParams.get('lng');

// Use lat and lng in your quiz logic (e.g., display location on map)
console.log("Hotspot Location:", lat, lng);

// ... rest of your swift.html code ...
function submitQuiz() {
    // ... your quiz logic ...
    const score = calculateScore(); // Your score calculation function
    window.opener.closeSwiftPopupAndUpdateScore(score);
    window.close();
}
```

## Step 3: Test the Integration

1. Open `ee.html` in your browser.
2. Click on an "Airquality" hotspot. The `swift.html` popup should appear, displaying the hotspot's location.
3. Complete the quiz in the popup. The popup should close, and your score should be updated in `ee.html`.



# Integrating swift.html into ee.html

This document provides instructions on integrating `swift.html` into `ee.html` to create an interactive quiz popup when an "Airquality" hotspot is clicked.

## Step 1: Modify ee.html

1. **Add a container for the popup:**  Inside the `<body>` of `ee.html`, add a `<div>` to hold the `swift.html` content.  This div should initially be hidden.

```html
<div id="swift-popup" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1002;"></div>
```

2. **Modify the `analyzeHotspot` function:**  Add code to open the popup if the hotspot type is "Airquality".  Use `document.getElementById('swift-popup').innerHTML` to load the content of `swift.html` into the popup.

```javascript
// ... inside analyzeHotspot function ...
if (currentHotspot.type === "AirQuality") {
    // Load swift.html into the popup
    fetch('swift.html')
        .then(response => response.text())
        .then(html => {
            document.getElementById('swift-popup').innerHTML = html;
            document.getElementById('swift-popup').style.display = 'block';
            // Add event listener to close popup and update score after quiz completion
            // ... (see Step 2) ...
        });
}
// ... rest of analyzeHotspot function ...
```

3. **Add a function to close the popup and update the score:** This function will be called from `swift.html` after the quiz is completed.

```javascript
function closeSwiftPopupAndUpdateScore(score) {
    document.getElementById('swift-popup').style.display = 'none';
    environmentalScore += score;
    document.getElementById('score').textContent = `Environmental Score: ${environmentalScore}`;
    updateSustainabilityRating();
}
```

## Step 2: Modify swift.html

1. **Add a function to send the score back to ee.html:**  Add a JavaScript function in `swift.html` that sends the user's score to `ee.html` using `window.opener.closeSwiftPopupAndUpdateScore(score)`.

```javascript
// ... inside swift.html ...
function submitQuiz() {
    // ... your quiz logic ...
    const score = calculateScore(); // Your score calculation function
    window.opener.closeSwiftPopupAndUpdateScore(score);
    window.close();
}
```

## Step 3: Test the Integration

1. Open `ee.html` in your browser.
2. Click on an "Airquality" hotspot.  The `swift.html` popup should appear.
3. Complete the quiz in the popup.  The popup should close, and your score should be updated in `ee.html`.
